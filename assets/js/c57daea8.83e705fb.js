"use strict";(self.webpackChunkxing_life_3=self.webpackChunkxing_life_3||[]).push([[8883],{3471:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>s,contentTitle:()=>t,default:()=>h,frontMatter:()=>c,metadata:()=>i,toc:()=>a});var r=o(4848),d=o(8453);const c={},t="Docker",i={id:"technique/docker/README",title:"Docker",description:"https://docs.docker.com/get-started/",source:"@site/docs/technique/docker/README.md",sourceDirName:"technique/docker",slug:"/technique/docker/",permalink:"/docs/technique/docker/",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"techniqueSidebar",previous:{title:"development tools",permalink:"/docs/technique/development_tools/"},next:{title:"Docusaurus",permalink:"/docs/technique/docusaurus/"}},s={},a=[{value:"docker hub token",id:"docker-hub-token",level:2},{value:"build image",id:"build-image",level:2},{value:"update image",id:"update-image",level:3},{value:"replace container",id:"replace-container",level:2},{value:"push image to docker hub",id:"push-image-to-docker-hub",level:2},{value:"docker run with command",id:"docker-run-with-command",level:2},{value:"Container Volumes",id:"container-volumes",level:2},{value:"Bind Mounts",id:"bind-mounts",level:2},{value:"watch log",id:"watch-log",level:2},{value:"docker Network",id:"docker-network",level:2},{value:"Docker-Compose",id:"docker-compose",level:2},{value:"Image Building Best",id:"image-building-best",level:2},{value:"docker-compose cases",id:"docker-compose-cases",level:2},{value:"Running a new instance",id:"running-a-new-instance",level:3},{value:"Stop environment",id:"stop-environment",level:3},{value:"Restart stopped containers",id:"restart-stopped-containers",level:3},{value:"Remove containers",id:"remove-containers",level:3},{value:"Remove containers and all associated images",id:"remove-containers-and-all-associated-images",level:3}];function l(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,d.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"docker",children:"Docker"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"https://docs.docker.com/get-started/",children:"https://docs.docker.com/get-started/"}),"\n",(0,r.jsx)(n.a,{href:"https://philipzheng.gitbook.io/docker_practice/",children:"https://philipzheng.gitbook.io/docker_practice/"})]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"list containers\n$ sudo docker container ls\n\nenter container\n$ sudo docker exec -it containerId bash\n"})}),"\n",(0,r.jsx)(n.h2,{id:"docker-hub-token",children:"docker hub token"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://docs.docker.com/go/access-tokens/",children:"https://docs.docker.com/go/access-tokens/"})}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"build-image",children:"build image"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'# In Dockerfile\nFROM node:12-alpine\n# Adding build tools to make yarn install work on Apple silicon / arm64 machines\nRUN apk add --no-cache python2 g++ make\nWORKDIR /app\nCOPY . .\nRUN yarn install --production\nCMD ["node", "src/index.js"]\n'})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"$ docker build -t getting-started .\n$ docker run -dp 3000:3000 getting-started\n"})}),"\n",(0,r.jsx)(n.h3,{id:"update-image",children:"update image"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"$ docker build -t getting-started . // just build again\u2026.\n"})}),"\n",(0,r.jsx)(n.h2,{id:"replace-container",children:"replace container"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"$ docker ps // list containers\n$ docker stop <the-container-id> // docker stop 73b58a640a5b\n$ docker rm  <the-container-id> //  docker rm 73b58a640a5b\nOr\n$ docker rm -f <the-container-id> // it will force stop and rm\n"})}),"\n",(0,r.jsx)(n.h2,{id:"push-image-to-docker-hub",children:"push image to docker hub"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"$ docker image ls\n$ docker login -u YOUR-USER-NAME\n$ docker tag getting-started YOUR-USER-NAME/getting-started\n$ docker push YOUR-USER-NAME/getting-started\n"})}),"\n",(0,r.jsx)(n.h2,{id:"docker-run-with-command",children:"docker run with command"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'$ docker run -d ubuntu bash -c "shuf -i 1-10000 -n 1 -o /data.txt && tail -f /dev/null"\n\n# docker exec command at container\n$ docker exec <container-id> cat /data.txt\n'})}),"\n",(0,r.jsx)(n.h2,{id:"container-volumes",children:"Container Volumes"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"$ docker volume create todo-db\n$ docker run -dp 3000:3000 -v todo-db:/etc/todos getting-started\n"})}),"\n",(0,r.jsx)(n.h2,{id:"bind-mounts",children:"Bind Mounts"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'$ docker run -dp 3000:3000 \\\n    -w /app -v "$(pwd):/app" \\\n    node:12-alpine \\\n    sh -c "yarn install && yarn run dev"\n'})}),"\n",(0,r.jsx)(n.h2,{id:"watch-log",children:"watch log"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"$ docker logs -f <container-id>\n"})}),"\n",(0,r.jsx)(n.h2,{id:"docker-network",children:"docker Network"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'$ docker run -d \\\n    --network todo-app --network-alias mysql \\\n    -v todo-mysql-data:/var/lib/mysql \\\n    -e MYSQL_ROOT_PASSWORD=secret \\\n    -e MYSQL_DATABASE=todos \\\n    mysql:5.7\n\n$ docker exec -it <mysql-container-id> mysql -p // go to mysql console\n\n$ docker run -it --network todo-app nicolaka/netshoot // another container app\n$ dig mysql // using dig to find the mysql server ip at the todo-app\n\n$ docker run -dp 3000:3000 \\\n  -w /app -v "$(pwd):/app" \\\n  --network todo-app \\\n  -e MYSQL_HOST=mysql \\\n  -e MYSQL_USER=root \\\n  -e MYSQL_PASSWORD=secret \\\n  -e MYSQL_DB=todos \\\n  node:12-alpine \\\n  sh -c "yarn install && yarn run dev"\n\nUsing docker logs to check the app connect the mysql\n\u2026\u2026\n'})}),"\n",(0,r.jsx)(n.h2,{id:"docker-compose",children:"Docker-Compose"}),"\n",(0,r.jsx)(n.p,{children:"it is a tool."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"$ docker-compose version // checking exist and tool version\n// write compose file\n$ docker-compose up -d\n$ docker-compose down\n$ docker-compose up\n$ docker-compose down --volumes // it will remove volumes\n"})}),"\n",(0,r.jsx)(n.h2,{id:"image-building-best",children:"Image Building Best"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"$ docker image history getting-started // to view history of the image\n"})}),"\n",(0,r.jsx)(n.h2,{id:"docker-compose-cases",children:"docker-compose cases"}),"\n",(0,r.jsx)(n.h3,{id:"running-a-new-instance",children:"Running a new instance"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"$ sudo docker-compose -f docker.ymal -p projectName up -d\n"})}),"\n",(0,r.jsx)(n.h3,{id:"stop-environment",children:"Stop environment"}),"\n",(0,r.jsx)(n.p,{children:"$ sudo docker-compose -f docker.ymal -p projectName stop"}),"\n",(0,r.jsx)(n.h3,{id:"restart-stopped-containers",children:"Restart stopped containers"}),"\n",(0,r.jsx)(n.p,{children:"$ sudo docker-compose -f docker.ymal -p projectName start"}),"\n",(0,r.jsx)(n.h3,{id:"remove-containers",children:"Remove containers"}),"\n",(0,r.jsx)(n.p,{children:"$ sudo docker-compose -f docker.ymal -p projectName rm -v"}),"\n",(0,r.jsx)(n.h3,{id:"remove-containers-and-all-associated-images",children:"Remove containers and all associated images"}),"\n",(0,r.jsx)(n.p,{children:"$ sudo docker-compose -f docker.ymal -p projectName down -v"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'"docker-compose down": stop and remove the container with all the networks (but not volumes), you should add -v option to do that.\n"docker-compose rm": remove stopped only containers, but not running containers, you should add option -s to be able to remove running containers\n'})})]})}function h(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},8453:(e,n,o)=>{o.d(n,{R:()=>t,x:()=>i});var r=o(6540);const d={},c=r.createContext(d);function t(e){const n=r.useContext(c);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:t(e.components),r.createElement(c.Provider,{value:n},e.children)}}}]);