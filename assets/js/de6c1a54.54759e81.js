"use strict";(self.webpackChunkxing_life_3=self.webpackChunkxing_life_3||[]).push([[1578],{1982:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>i,contentTitle:()=>l,default:()=>h,frontMatter:()=>r,metadata:()=>o,toc:()=>d});var n=t(4848),a=t(8453);const r={},l="MySQL",o={id:"technique/database_sql/mysql/README",title:"MySQL",description:"Table size",source:"@site/docs/technique/database_sql/mysql/README.md",sourceDirName:"technique/database_sql/mysql",slug:"/technique/database_sql/mysql/",permalink:"/docs/technique/database_sql/mysql/",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"techniqueSidebar",previous:{title:"Analyze",permalink:"/docs/technique/database_sql/analyze"},next:{title:"backup data",permalink:"/docs/technique/database_sql/mysql/backup_data"}},i={},d=[{value:"Table size",id:"table-size",level:2},{value:"Database size",id:"database-size",level:2},{value:"table struct",id:"table-struct",level:2},{value:"start, stop, restart MySQL",id:"start-stop-restart-mysql",level:2},{value:"On Linux start/stop/restart from the command line:",id:"on-linux-startstoprestart-from-the-command-line",level:3},{value:"On macOS Sierra &amp; OS to start/stop/restart MySQL post 5.7 from the command line:",id:"on-macos-sierra--os-to-startstoprestart-mysql-post-57-from-the-command-line",level:3},{value:"On OS X to start/stop/restart MySQL pre 5.7 from the command line:",id:"on-os-x-to-startstoprestart-mysql-pre-57-from-the-command-line",level:3},{value:"mysql_secure_installation",id:"mysql_secure_installation",level:2},{value:"User",id:"user",level:2},{value:"check allowed user access from",id:"check-allowed-user-access-from",level:3},{value:"create",id:"create",level:3},{value:"authorization",id:"authorization",level:3},{value:"port",id:"port",level:2},{value:"Enable remote for MariaDB",id:"enable-remote-for-mariadb",level:2}];function c(e){const s={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.header,{children:(0,n.jsx)(s.h1,{id:"mysql",children:"MySQL"})}),"\n",(0,n.jsx)(s.h2,{id:"table-size",children:"Table size"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{children:"SELECT concat(table_schema,'.',table_name),\nconcat(round(table_rows/1000000,2),'M') rows,\nconcat(round(data_length/(1024*1024*1024),2),'G') DATA,\nconcat(round(index_length/(1024*1024*1024),2),'G') idx,\nconcat(round((data_length+index_length)/(1024*1024*1024),2),'G') total_size,\nround(index_length/data_length,2) idxfrac\nFROM information_schema.TABLES\nORDER BY data_length+index_length DESC LIMIT 20;\n\n# where table_schema='note'; note \u6539\u8cc7\u6599\u5eab\u540d\u7a31\n"})}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{children:"# \u52a0\u7e3d\nSELECT round(sum(data_length)/(1024*1024),2) DATA_SUM,\n-> round(sum(index_length)/(1024*1024),2) INDEX_SUM,\n-> round(sum(data_length)+sum(index_length),2) TOTAL\n-> FROM information_schema.TABLES\n-> where table_schema='note';\n"})}),"\n",(0,n.jsx)(s.h2,{id:"database-size",children:"Database size"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{children:'SELECT table_schema AS "Database name",\nSUM(data_length + index_length) / 1024 / 1024 AS "Size (MB)"\nFROM information_schema.TABLES\nGROUP BY table_schema;\n'})}),"\n",(0,n.jsx)(s.h2,{id:"table-struct",children:"table struct"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{children:"SHOW FULL FIELDS FROM database.table\nSHOW FULL FIELDS FROM table FROM database\nSHOW FULL FIELDS FROM table # \u82e5\u5df2\u7d93 use database \u904e\u4e86, \u9019\u6a23\u5b50\u5373\u53ef\nDESC table //\u986f\u793a\u6bd4\u8f03\u5c11\u6b04\u4f4d\u7684\u8cc7\u6599\u7d50\u69cb\n"})}),"\n",(0,n.jsx)(s.h2,{id:"start-stop-restart-mysql",children:"start, stop, restart MySQL"}),"\n",(0,n.jsx)(s.h3,{id:"on-linux-startstoprestart-from-the-command-line",children:"On Linux start/stop/restart from the command line:"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{children:"sudo /etc/init.d/mysqld start\nsudo /etc/init.d/mysqld stop\nsudo /etc/init.d/mysqld restart\n\nsudo service mysqld start\nsudo service mysqld stop\nsudo service mysqld restart\n\nsudo service mysql start\nsudo service mysql stop\nsudo service mysql restart\n"})}),"\n",(0,n.jsx)(s.h3,{id:"on-macos-sierra--os-to-startstoprestart-mysql-post-57-from-the-command-line",children:"On macOS Sierra & OS to start/stop/restart MySQL post 5.7 from the command line:"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{children:"sudo launchctl load -F /Library/LaunchDaemons/com.oracle.oss.mysql.mysqld.plist\nsudo launchctl unload -F /Library/LaunchDaemons/com.oracle.oss.mysql.mysqld.plist\n"})}),"\n",(0,n.jsx)(s.h3,{id:"on-os-x-to-startstoprestart-mysql-pre-57-from-the-command-line",children:"On OS X to start/stop/restart MySQL pre 5.7 from the command line:"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{children:"sudo /usr/local/mysql/support-files/mysql.server start\nsudo /usr/local/mysql/support-files/mysql.server stop\nsudo /usr/local/mysql/support-files/mysql.server restart\n"})}),"\n",(0,n.jsx)(s.h2,{id:"mysql_secure_installation",children:"mysql_secure_installation"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{children:"mysql_secure_installation\n"})}),"\n",(0,n.jsx)(s.h2,{id:"user",children:"User"}),"\n",(0,n.jsx)(s.h3,{id:"check-allowed-user-access-from",children:"check allowed user access from"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{children:"select user,host from mysql.user;\n"})}),"\n",(0,n.jsx)(s.h3,{id:"create",children:"create"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{children:"CREATE USER 'user'@'localhost' IDENTIFIED BY 'PASSWORD'\nGRANT ALL PRIVILEGES ON database_name.* TO 'user'@'localhost';\nFLUSH PRIVILEGES;\n"})}),"\n",(0,n.jsx)(s.h3,{id:"authorization",children:"authorization"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{children:"SHOW GRANTS FOR user_name@localhost;\nGRANT ALL ON * . * TO 'user_name'@'localhost';\nGRANT ALL PRIVILEGES ON 'test'.* TO 'user_name'@'localhost';\n"})}),"\n",(0,n.jsx)(s.h2,{id:"port",children:"port"}),"\n",(0,n.jsxs)(s.blockquote,{children:["\n",(0,n.jsxs)(s.blockquote,{children:["\n",(0,n.jsxs)(s.p,{children:["ref: ",(0,n.jsx)(s.a,{href:"http://blog.itist.tw/2015/02/raspberry-pi-install-mysql-or-mariadb.html",children:"http://blog.itist.tw/2015/02/raspberry-pi-install-mysql-or-mariadb.html"})]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{children:"sudo iptables -A INPUT -p TCP -i eth0 --dport 3306 --sport 1024:65534 -j ACCEPT\n"})}),"\n",(0,n.jsx)(s.h2,{id:"enable-remote-for-mariadb",children:"Enable remote for MariaDB"}),"\n",(0,n.jsxs)(s.blockquote,{children:["\n",(0,n.jsxs)(s.blockquote,{children:["\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.a,{href:"https://webdock.io/en/docs/how-guides/database-guides/how-enable-remote-access-your-mariadbmysql-database",children:"https://webdock.io/en/docs/how-guides/database-guides/how-enable-remote-access-your-mariadbmysql-database"})}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(s.p,{children:"check service and port status"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{children:"ps -ef | grep -i mysql\nnetstat -ant | grep 3306\n"})}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{children:"vim /etc/mysql/my.cnf\n[mysqld]\nbind-address = 0.0.0.0\n\n\nsudo systemctl restart mariadb\n"})})]})}function h(e={}){const{wrapper:s}={...(0,a.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(c,{...e})}):c(e)}},8453:(e,s,t)=>{t.d(s,{R:()=>l,x:()=>o});var n=t(6540);const a={},r=n.createContext(a);function l(e){const s=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:l(e.components),n.createElement(r.Provider,{value:s},e.children)}}}]);