"use strict";(self.webpackChunkxing_life_3=self.webpackChunkxing_life_3||[]).push([[1899],{6655:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>c,contentTitle:()=>o,default:()=>a,frontMatter:()=>h,metadata:()=>r,toc:()=>l});var t=n(4848),i=n(8453);const h={},o="SSH",r={id:"technique/ssh/README",title:"SSH",description:"github",source:"@site/docs/technique/ssh/README.md",sourceDirName:"technique/ssh",slug:"/technique/ssh/",permalink:"/docs/technique/ssh/",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"techniqueSidebar",previous:{title:"SQL Server",permalink:"/docs/technique/sql_server/"},next:{title:"Swift",permalink:"/docs/technique/swift/"}},c={},l=[{value:"github",id:"github",level:2},{value:"general",id:"general",level:2},{value:"ssh agent",id:"ssh-agent",level:2},{value:"proxy add agent",id:"proxy-add-agent",level:2},{value:"pem key",id:"pem-key",level:2},{value:"Too many authentication failures",id:"too-many-authentication-failures",level:2},{value:"add key in authorized_keys for ssh login",id:"add-key-in-authorized_keys-for-ssh-login",level:2},{value:"ssh socket",id:"ssh-socket",level:2},{value:"using ssh/config",id:"using-sshconfig",level:3},{value:"using SSH_SOCKET",id:"using-ssh_socket",level:3},{value:"set socket path",id:"set-socket-path",level:4},{value:"use the sshsocket",id:"use-the-sshsocket",level:4},{value:"close the sshsocket",id:"close-the-sshsocket",level:4},{value:"auto load ssh key",id:"auto-load-ssh-key",level:2}];function d(e){const s={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.header,{children:(0,t.jsx)(s.h1,{id:"ssh",children:"SSH"})}),"\n",(0,t.jsx)(s.h2,{id:"github",children:"github"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:'ssh-keygen -t ed25519 -C "xing312101@gmail.com"\n\npbcopy sshKey.pub to the server\n\n$ vim config\nHost github.com\n  AddKeysToAgent yes\n  UseKeychain yes\n  IdentityFile ~/.ssh/sshKey.pub\n'})}),"\n",(0,t.jsx)(s.h2,{id:"general",children:"general"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:'ssh-keygen -m PEM -t rsa -b 4096\n\nssh-keygen \\\n    -m PEM \\\n    -t rsa \\\n    -b 4096 \\\n    -C "xing312101@server" \\\n    -f ~/.ssh/otherKeys/privateKeyName \\\n    -N mypassphrase\n\n-m PEM = \u5c07\u91d1\u9470\u683c\u5f0f\u8a2d\u5b9a\u70ba PEM\n-t rsa = \u8981\u5efa\u7acb\u7684\u91d1\u9470\u985e\u578b\uff0c\u5728\u6b64\u6848\u4f8b\u4e2d\u63a1\u7528 RSA \u683c\u5f0f\n-b 4096 = \u91d1\u9470\u4e2d\u7684\u4f4d\u5143\u6578\uff0c\u5728\u6b64\u6848\u4f8b\u4e2d\u70ba 4096\n-C "xing312101@server" = \u9644\u52a0\u81f3\u516c\u958b\u91d1\u9470\u6a94\u6848\u7d50\u5c3e\u4ee5\u4fbf\u8f15\u9b06\u8b58\u5225\u7684\u8a3b\u89e3\uff0c\u901a\u5e38\u6703\u4ee5\u96fb\u5b50\u90f5\u4ef6\u5730\u5740\u4f5c\u70ba\u8a3b\u89e3\n-f ~/.ssh/mykeys/myprivatekey = \u79c1\u5bc6\u91d1\u9470\u6a94\u6848\u7684\u6a94\u6848\u540d\u7a31\n-N mypassphrase = \u5b58\u53d6\u79c1\u5bc6\u91d1\u9470\u7684\u5bc6\u78bc\u3002\n'})}),"\n",(0,t.jsx)(s.h2,{id:"ssh-agent",children:"ssh agent"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"eval $(ssh-agent -s)\n\nssh-add ~/.ssh/id_rsa\n"})}),"\n",(0,t.jsx)(s.h2,{id:"proxy-add-agent",children:"proxy add agent"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:'echo "Host *\\n StrictHostKeyChecking no\\n UserKnownHostsFile /dev/null\\n ForwardAgent yes$(cat ~/.ssh/config)" > ~/.ssh/config\necho -e "Host * \\n\\tStrictHostKeyChecking no\\n\\tUserKnownHostsFile /dev/null" >> ~/.ssh/config\n'})}),"\n",(0,t.jsx)(s.h2,{id:"pem-key",children:"pem key"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"ssh -i keyName.pem user@host\n"})}),"\n",(0,t.jsx)(s.p,{children:"####public issue\nvim  ~/.ssh/config"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"Host *\n    PubkeyAcceptedKeyTypes +ssh-rsa\n"})}),"\n",(0,t.jsx)(s.h2,{id:"too-many-authentication-failures",children:"Too many authentication failures"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"1.\nssh -o IdentitiesOnly=yes user@localhost\n\n2. ~/.ssh/config\nHost *\n  IdentitiesOnly=yes\n"})}),"\n",(0,t.jsx)(s.h2,{id:"add-key-in-authorized_keys-for-ssh-login",children:"add key in authorized_keys for ssh login"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"mkdir authorized_keys in ~/.ssh\n"})}),"\n",(0,t.jsx)(s.h2,{id:"ssh-socket",children:"ssh socket"}),"\n",(0,t.jsx)(s.h3,{id:"using-sshconfig",children:"using ssh/config"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"Host 10.10.10.115\n  ControlMaster auto\n  ControlPath path # like /.ssh/xxx_control or /tmp/serverNameControl\n  ControlPersist 2h\n"})}),"\n",(0,t.jsx)(s.h3,{id:"using-ssh_socket",children:"using SSH_SOCKET"}),"\n",(0,t.jsxs)(s.blockquote,{children:["\n",(0,t.jsx)(s.p,{children:"not success, need to check"}),"\n"]}),"\n",(0,t.jsx)(s.h4,{id:"set-socket-path",children:"set socket path"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"ENV_VARIABLE=socketPath\nex: ENV_VARIABLE=~/.ssh/user@hostName\n"})}),"\n",(0,t.jsx)(s.h4,{id:"use-the-sshsocket",children:"use the sshsocket"}),"\n",(0,t.jsxs)(s.ol,{children:["\n",(0,t.jsx)(s.li,{children:"create master connection"}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"ssh -M -f -N -o ControlPath=$ENV_VARIABLE myUsername@targetServerName\n"})}),"\n",(0,t.jsxs)(s.ol,{start:"2",children:["\n",(0,t.jsx)(s.li,{children:"use"}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"ssh -o ControlPath=$ENV_VARIABLE user@hostName \"echo 'Hello Xing'; ls\"\n\nscp -o ControlPath=$ENV_VARIABLE user@hostName:remoteFile.txt ./\n"})}),"\n",(0,t.jsx)(s.h4,{id:"close-the-sshsocket",children:"close the sshsocket"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"ssh -S $ENV_VARIABLE -O exit user@hostName\n"})}),"\n",(0,t.jsx)(s.h2,{id:"auto-load-ssh-key",children:"auto load ssh key"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"Host *\n  UseKeychain yes\n  AddKeysToAgent yes\n  IdentityFile ~/.ssh/[your-secure-ssh-key-name]\n"})})]})}function a(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,s,n)=>{n.d(s,{R:()=>o,x:()=>r});var t=n(6540);const i={},h=t.createContext(i);function o(e){const s=t.useContext(h);return t.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function r(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),t.createElement(h.Provider,{value:s},e.children)}}}]);